<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quizzatopia Community</title>
    <meta name="robots" content="nofollow">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"  crossorigin="anonymous">


  <script  defer src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.3/umd/popper.min.js"></script>

  <script  defer src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>

	  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">
	  <script  defer src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.2/js/bootstrap.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <link rel="stylesheet" href="./style.css" />
  
    <link rel="import" href="./elements/navbar.html">
    <link rel="import" href="./elements/footer.html">
	  
	   <div id="navbar"></div>
  <!-- Firebase SDK -->
  <script  src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script  src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script  src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

  <!-- Custom scripts -->
  <script  src="/main.js"></script> 
  	<style>
	

		.shadow {
			box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
		}
	</style>
 </head>
<body>
  <!-- Header -->

  <button class="start-discussion-button" onclick="openCreateThreadPopup()">Start Discussion</button>


  <!-- Main Content -->
  <main>
	  
    <!-- Channel Sidebar -->
    <aside class="channel-sidebar">
      <h2>Channels</h2>
      <!-- Display a list of channels -->
      <ul>
        <li><a href="#">General Knowledge</a></li>
        <li><a href="#">Pop Culture</a></li>
        <li><a href="#">Science</a></li>
        <!-- Add more channels here -->
      </ul>
    </aside>

    <!-- Thread Listing -->
   <section class="thread-listing">
  <h2>Thread Listing</h2>
  <ul id="thread-list"></ul>
</section>


	  
	  
	  
	  
	  
	  
	  
	  
    <!-- Thread Details -->
    <section class="thread-details">
      <h2>Thread Title</h2>
      <!-- Display thread details like author, date, content, replies, etc. -->
      <div class="thread-content">
        <p>Thread content goes here</p>
      </div>
      <div class="replies">
        <!-- Display thread replies -->
        <div class="reply">
          <!-- Display individual reply content -->
        </div>
        <!-- Add more replies here -->
      </div>
    </section>

	  
	  
	  
	  
	  
	  
	  
    <!-- Create Thread Form -->
<section class="create-thread-popup">
  <div class="create-thread-container">
    <button class="exit-button" onclick="closeCreateThreadPopup()">X</button>
    <h2>Create a New Thread</h2>
    <form id="create-thread-form">
      <label for="thread-title">Thread Title:</label>
      <input type="text" id="thread-title" required>

      <label for="thread-content">Thread Content:</label>
      <textarea id="thread-content" required></textarea>

      <button type="submit">Create Thread</button>
    </form>
  </div>
</section>


  </main>


  <!-- Include your JavaScript files here to integrate Firebase functionality -->
	
	<script>
		
function openCreateThreadPopup() {
  document.querySelector('.create-thread-popup').style.display = 'block';
}

function closeCreateThreadPopup() {
  document.querySelector('.create-thread-popup').style.display = 'none';
}	
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		// Initialize Firebase
//firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

		
		
// Retrieve the thread ID from the URL query parameter (replace 'threadId' with the actual parameter name)
const urlParams = new URLSearchParams(window.location.search);
const threadId = urlParams.get('threadId');

// Reference to the thread content and reply list elements
const threadContent = document.getElementById('thread-content');
const replyList = document.getElementById('reply-list');

// Function to retrieve the selected thread's details from Firebase
function getThreadDetails() {
  // Retrieve the thread data from Firestore using the thread ID
  db.collection('threads').doc(threadId).get()
    .then((doc) => {
      if (doc.exists) {
        const threadData = doc.data();

        // Display the thread content
        threadContent.innerHTML = `
          <h3>${threadData.title}</h3>
          <p>Author: ${threadData.author}</p>
          <p>Timestamp: ${threadData.timestamp}</p>
          <p>${threadData.content}</p>
        `;
      } else {
        console.log("Thread not found");
      }
    })
    .catch((error) => {
      console.log("Error getting thread details:", error);
    });
}

// Function to retrieve and display the replies for the selected thread
function getReplies() {
  // Retrieve the replies from Firestore using the thread ID
  db.collection('replies').where('threadId', '==', threadId).get()
    .then((querySnapshot) => {
      replyList.innerHTML = ''; // Clear existing replies

      querySnapshot.forEach((doc) => {
        const replyData = doc.data();

        // Create a list item for each reply
        const listItem = document.createElement('li');
        listItem.innerHTML = `
          <p>Author: ${replyData.author}</p>
          <p>Timestamp: ${replyData.timestamp}</p>
          <p>${replyData.content}</p>
        `;

        replyList.appendChild(listItem);
      });
    })
    .catch((error) => {
      console.log("Error getting replies:", error);
    });
}


// Function to add a new reply to the thread
function addReply(content) {
  // Get the current user's information (replace with your authentication system)
  const currentUser = {
    name: 'John Doe', // Example name
    // Other user information
  };

  // Create a new reply object
  const newReply = {
    author: currentUser.name,
    content: content,
    timestamp: new Date().toISOString(),
    threadId: threadId,
  };

  // Add the new reply to the 'replies' collection in Firestore
  db.collection('replies').add(newReply)
    .then((docRef) => {
      console.log("New reply added with ID: ", docRef.id);
    })
    .catch((error) => {
      console.error("Error adding reply: ", error);
    });
}


// Call the functions to retrieve and display the thread details and replies on page load
getThreadDetails();
getReplies();
		
		
		
		
		
		
		
		
// Reference to the thread list element
const threadList = document.getElementById('thread-list');

// Function to retrieve thread data from Firebase and populate the thread list
function populateThreadList() {
  // Retrieve thread data from Firebase (replace 'threads' with your Firebase database reference)
  firebase.database().ref('threads').on('value', (snapshot) => {
    threadList.innerHTML = ''; // Clear existing thread list

    snapshot.forEach((childSnapshot) => {
      const threadData = childSnapshot.val();

      // Create a list item for each thread
      const listItem = document.createElement('li');
      
      // Set the thread title, author, timestamp, etc.
      listItem.innerHTML = `
        <h3>${threadData.title}</h3>
        <p>Author: ${threadData.author}</p>
        <p>Timestamp: ${threadData.timestamp}</p>
        <!-- Additional thread information can be added here -->

        <a href="thread-details.html?threadId=${childSnapshot.key}">View Details</a>
      `;

      threadList.appendChild(listItem);
    });
  });
}

// Call the function to populate the thread list on page load
populateThreadList();
		
		
		
		
		
		
		
		
		
		
		
		// Get a reference to the form element
const createThreadForm = document.getElementById('create-thread-form');

// Add event listener for form submission
createThreadForm.addEventListener('submit', (event) => {
  event.preventDefault(); // Prevent the default form submission

  // Get the values from the form fields
  const threadTitle = document.getElementById('thread-title').value;
  const threadContent = document.getElementById('thread-content').value;

  // Perform necessary actions (e.g., save to Firebase, update UI, etc.)
  createThread(threadTitle, threadContent);
  
  // Reset the form
  createThreadForm.reset();
});

// Function to create a new thread
function createThread(title, content) {
  // Implement the logic to create a new thread in Firebase
  // This could include pushing the data to the Firebase Realtime Database or Firestore
  // You can use Firebase SDKs and methods to handle data storage and updates
  // Example code:
  firebase.database().ref('threads').push({
    title: title,
    content: content,
    // Other thread properties like author, timestamp, etc.
  });
}

		
		
		
	</script>
</body>
  <!-- Footer -->

</html>

